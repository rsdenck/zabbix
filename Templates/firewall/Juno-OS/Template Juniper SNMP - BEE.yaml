zabbix_export:
  version: '6.0'
  date: '2023-11-21T15:57:30Z'
  groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: 7fd72970aa7743c3aa8c1677ea0abdfd
      template: 'Template Juniper SNMP - BEE'
      name: 'Template Juniper SNMP - BEE'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 4c8cfbbeaedc431aade97e0f3cee16cb
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 7f0f56afc2d143fb91ae929004182fb9
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 8afaddf40d7a4066a55de7d4e37e8063
          name: 'Hardware model name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2636.3.1.2.0
          key: system.hw.model
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: JUNIPER-MIB
            The name, model, or detailed description of the box,indicating which product the box is about, for example 'M40'.
          inventory_link: MODEL
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
        -
          uuid: 84cdf21e4a7c4524a3d8661a54e753c9
          name: 'Hardware serial number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2636.3.1.3.0
          key: system.hw.serialnumber
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: JUNIPER-MIB
            The serial number of this subject, blank if unknown or unavailable.
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 59d01833c3b04689afd941a85923f731
              expression: 'last(/Template Juniper SNMP - BEE/system.hw.serialnumber,#1)<>last(/Template Juniper SNMP - BEE/system.hw.serialnumber,#2) and length(last(/Template Juniper SNMP - BEE/system.hw.serialnumber))>0'
              name: 'Device has been replaced'
              event_name: 'Device has been replaced (new serial number received)'
              priority: INFO
              description: 'Device serial number has changed. Ack to close'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: d19c2ed367b547509e7bd6b0c8106519
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.1.1.0
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            -
              type: CHECK_NOT_SUPPORTED
              parameters:
                - ''
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: component
              value: system
        -
          uuid: a5ed352ec1cf4b839ca03988b66dc34d
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 8355564cca2f46f29506fbfd398ebc07
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 775cde47210646e09b1b68d2960582fe
              expression: 'last(/Template Juniper SNMP - BEE/system.name,#1)<>last(/Template Juniper SNMP - BEE/system.name,#2) and length(last(/Template Juniper SNMP - BEE/system.name))>0'
              name: 'System name has changed'
              event_name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
                -
                  tag: scope
                  value: security
        -
          uuid: 53a52a701f674999a0c9fb11e90d60df
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: component
              value: system
        -
          uuid: bc112007448b4653a1535837c988c22b
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            -
              tag: component
              value: system
        -
          uuid: ce5e252eb7df45528232e7163940e7fe
          name: 'Overall system health status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2636.3.4.2.3.1.0
          key: 'system.status[jnxRedAlarmState.0]'
          delay: 30s
          history: 2w
          trends: 0d
          description: |
            MIB: JUNIPER-ALARM-MIB
            The red alarm indication on the craft interface panel.
            The red alarm is on when there is some system
            failure or power supply failure or the system
            is experiencing a hardware malfunction or some
            threshold is being exceeded.
            
            This red alarm state could be turned off by the
            ACO/LT (Alarm Cut Off / Lamp Test) button on the
            front panel module.
          valuemap:
            name: 'JUNIPER-ALARM-MIB::jnxRedAlarmState'
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 6081348bb15f41819848d87beaeebfb2
              expression: 'count(/Template Juniper SNMP - BEE/system.status[jnxRedAlarmState.0],#1,"eq","{$HEALTH_CRIT_STATUS}")=1'
              name: 'System status is in critical state'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Please check the device for errors'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: performance
        -
          uuid: c7f12dcf30e04c0083c96f5bf6bd5abc
          name: 'Operating system'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.sw.os[sysDescr.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'MIB: SNMPv2-MIB'
          inventory_link: OS
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'kernel (JUNOS [0-9a-zA-Z\.\-]+)'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: os
          triggers:
            -
              uuid: 33ed719a3c9e4a469da6e1d2003ed7e1
              expression: 'last(/Template Juniper SNMP - BEE/system.sw.os[sysDescr.0],#1)<>last(/Template Juniper SNMP - BEE/system.sw.os[sysDescr.0],#2) and length(last(/Template Juniper SNMP - BEE/system.sw.os[sysDescr.0]))>0'
              name: 'Operating system description has changed'
              priority: INFO
              description: 'Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'System name has changed'
                  expression: 'last(/Template Juniper SNMP - BEE/system.name,#1)<>last(/Template Juniper SNMP - BEE/system.name,#2) and length(last(/Template Juniper SNMP - BEE/system.name))>0'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 107e2d5f24cd4cb19746b01c6f4e00ef
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible value:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          tags:
            -
              tag: component
              value: health
            -
              tag: component
              value: network
          triggers:
            -
              uuid: b977d216315b406aaa3b6b4203a389db
              expression: 'max(/Template Juniper SNMP - BEE/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              tags:
                -
                  tag: scope
                  value: availability
      discovery_rules:
        -
          uuid: 43ccc903abe24d4ab5ab8f1569a3c13a
          name: 'CPU and Memory Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.1.13.1.5]'
          key: jnxOperatingTable.discovery
          delay: 1h
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: 'Routing Engine.*'
                formulaid: A
          description: |
            Scanning JUNIPER-MIB::jnxOperatingTable for CPU and Memory
            http://kb.juniper.net/InfoCenter/index?page=content&id=KB17526&actp=search. Filter limits results to Routing Engines
          item_prototypes:
            -
              uuid: c5a7cb1ed2ba40579d204a2cce2af0f5
              name: '{#SNMPVALUE}: CPU utilization'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.1.13.1.8.{#SNMPINDEX}'
              key: 'system.cpu.util[jnxOperatingCPU.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: JUNIPER-MIB
                The CPU utilization in percentage of this subject. Zero if unavailable or inapplicable.
                Reference: http://kb.juniper.net/library/CUSTOMERSERVICE/GLOBAL_JTAC/BK26199/SRX%20SNMP%20Monitoring%20Guide_v1.1.pdf
              tags:
                -
                  tag: component
                  value: cpu
              trigger_prototypes:
                -
                  uuid: 2c5c11244f5c4e28913c6e0e9b789e37
                  expression: 'min(/Template Juniper SNMP - BEE/system.cpu.util[jnxOperatingCPU.{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: '{#SNMPVALUE}: High CPU utilization'
                  event_name: '{#SNMPVALUE}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 1668b72732ba4c1b84125b13df03fea9
              name: '{#SNMPVALUE}: Memory utilization'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.1.13.1.11.{#SNMPINDEX}'
              key: 'vm.memory.util[jnxOperatingBuffer.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: JUNIPER-MIB
                The buffer pool utilization in percentage of this subject.  Zero if unavailable or inapplicable.
                Reference: http://kb.juniper.net/library/CUSTOMERSERVICE/GLOBAL_JTAC/BK26199/SRX%20SNMP%20Monitoring%20Guide_v1.1.pdf
              tags:
                -
                  tag: component
                  value: memory
              trigger_prototypes:
                -
                  uuid: be86b308a5b940b497ccbeaaf96eef73
                  expression: 'min(/Template Juniper SNMP - BEE/vm.memory.util[jnxOperatingBuffer.{#SNMPINDEX}],5m)>{$MEMORY.UTIL.MAX}'
                  name: '{#SNMPVALUE}: High memory utilization'
                  event_name: '{#SNMPVALUE}: High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
                  priority: AVERAGE
                  description: 'The system is running out of free memory.'
                  tags:
                    -
                      tag: scope
                      value: capacity
                    -
                      tag: scope
                      value: performance
          graph_prototypes:
            -
              uuid: 7372424231fa42358b3d0a750e307b22
              name: '{#SNMPVALUE}: CPU utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Template Juniper SNMP - BEE'
                    key: 'system.cpu.util[jnxOperatingCPU.{#SNMPINDEX}]'
            -
              uuid: 96d51a906d564417ae80e28eb8b6aec7
              name: '{#SNMPVALUE}: Memory utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Template Juniper SNMP - BEE'
                    key: 'vm.memory.util[jnxOperatingBuffer.{#SNMPINDEX}]'
        -
          uuid: 2c4fb3f6263240a69d3dea950135f78c
          name: 'FAN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.1.13.1.5.4]'
          key: jnxOperatingTable.discovery.fans
          delay: 1h
          description: 'Scanning JUNIPER-MIB::jnxOperatingTable for Fans'
          item_prototypes:
            -
              uuid: b15a95f7c993483fa4bad372b0431149
              name: '{#SNMPVALUE}: Fan status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.1.13.1.6.4.{#SNMPINDEX}'
              key: 'sensor.fan.status[jnxOperatingState.4.{#SNMPINDEX}]'
              delay: 3m
              history: 2w
              trends: 0d
              description: 'MIB: JUNIPER-MIB'
              valuemap:
                name: 'JUNIPER-ALARM-MIB::jnxOperatingState'
              tags:
                -
                  tag: component
                  value: fan
              trigger_prototypes:
                -
                  uuid: 69e9a021d690404db75971b86042e6a6
                  expression: 'count(/Template Juniper SNMP - BEE/sensor.fan.status[jnxOperatingState.4.{#SNMPINDEX}],#1,"eq","{$FAN_CRIT_STATUS}")=1'
                  name: '{#SNMPVALUE}: Fan is in critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the fan unit'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: performance
        -
          uuid: bdb3f55bc6e644218d953c75b5109966
          name: 'PSU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.1.13.1.5.2]'
          key: jnxOperatingTable.discovery.psu
          delay: 1h
          description: 'Scanning JUNIPER-MIB::jnxOperatingTable for Power Supplies'
          item_prototypes:
            -
              uuid: 5613b3454c654d68abc0b4c4c5ab10da
              name: '{#SNMPVALUE}: Power supply status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.1.13.1.6.2.{#SNMPINDEX}'
              key: 'sensor.psu.status[jnxOperatingState.2.{#SNMPINDEX}]'
              delay: 3m
              history: 2w
              trends: 0d
              description: |
                MIB: JUNIPER-MIB
                If they are using DC power supplies there is a known issue on PR 1064039 where the fans do not detect the temperature correctly and fail to cool the power supply causing the shutdown to occur.
                This is fixed in Junos 13.3R7 https://forums.juniper.net/t5/Routing/PEM-0-not-OK-MX104/m-p/289644#M14122
              valuemap:
                name: 'JUNIPER-ALARM-MIB::jnxOperatingState'
              tags:
                -
                  tag: component
                  value: power
              trigger_prototypes:
                -
                  uuid: 31aed30dd82745daae9971f98525ef3a
                  expression: 'count(/Template Juniper SNMP - BEE/sensor.psu.status[jnxOperatingState.2.{#SNMPINDEX}],#1,"eq","{$PSU_CRIT_STATUS}")=1'
                  name: '{#SNMPVALUE}: Power supply is in critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the power supply unit for errors'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: performance
        -
          uuid: 7be075e6562f4127b935e67eea436b80
          name: 'Temperature discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.1.13.1.7,{#SENSOR_INFO},1.3.6.1.4.1.2636.3.1.13.1.5]'
          key: jnxOperatingTable.discovery.temp
          delay: 1h
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: '[^0]+'
                formulaid: A
          description: |
            Scanning JUNIPER-MIB::jnxOperatingTable for Temperature
            http://kb.juniper.net/InfoCenter/index?page=content&id=KB17526&actp=search. Filter limits results to Routing Engines
          item_prototypes:
            -
              uuid: 3644eddf560c4b0c9b0f2ff22b452354
              name: '{#SENSOR_INFO}: Temperature'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.1.13.1.7.{#SNMPINDEX}'
              key: 'sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: JUNIPER-MIB
                The temperature in Celsius (degrees C) of {#SENSOR_INFO}
              tags:
                -
                  tag: component
                  value: temperature
              trigger_prototypes:
                -
                  uuid: 2610800290db47f9ad93097bbf5f2989
                  expression: 'avg(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"{#SENSOR_INFO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"{#SENSOR_INFO}"}-3'
                  name: '{#SENSOR_INFO}: Temperature is above critical threshold'
                  event_name: '{#SENSOR_INFO}: Temperature is above critical threshold: >{$TEMP_CRIT:"{#SENSOR_INFO}"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: performance
                -
                  uuid: f00840d55bf94588a6b1f876e8322a62
                  expression: 'avg(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)>{$TEMP_WARN:"{#SENSOR_INFO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)<{$TEMP_WARN:"{#SENSOR_INFO}"}-3'
                  name: '{#SENSOR_INFO}: Temperature is above warning threshold'
                  event_name: '{#SENSOR_INFO}: Temperature is above warning threshold: >{$TEMP_WARN:"{#SENSOR_INFO}"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    -
                      name: '{#SENSOR_INFO}: Temperature is above critical threshold'
                      expression: 'avg(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"{#SENSOR_INFO}"}'
                      recovery_expression: 'max(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"{#SENSOR_INFO}"}-3'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: performance
                -
                  uuid: 951c69709ee64cdfadf35f8d4781b380
                  expression: 'avg(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)<{$TEMP_CRIT_LOW:"{#SENSOR_INFO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'min(/Template Juniper SNMP - BEE/sensor.temp.value[jnxOperatingTemp.{#SNMPINDEX}],5m)>{$TEMP_CRIT_LOW:"{#SENSOR_INFO}"}+3'
                  name: '{#SENSOR_INFO}: Temperature is too low'
                  event_name: '{#SENSOR_INFO}: Temperature is too low: <{$TEMP_CRIT_LOW:"{#SENSOR_INFO}"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: performance
      tags:
        -
          tag: class
          value: network
        -
          tag: target
          value: juniper
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        -
          macro: '{$FAN_CRIT_STATUS}'
          value: '6'
        -
          macro: '{$HEALTH_CRIT_STATUS}'
          value: '3'
        -
          macro: '{$ICMP_LOSS_WARN}'
          value: '20'
        -
          macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
        -
          macro: '{$IF.ERRORS.WARN}'
          value: '2'
        -
          macro: '{$IF.UTIL.MAX}'
          value: '90'
        -
          macro: '{$IFCONTROL}'
          value: '1'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
        -
          macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Ignore notPresent(6)'
        -
          macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        -
          macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
        -
          macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        -
          macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        -
          macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        -
          macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        -
          macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        -
          macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        -
          macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        -
          macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
        -
          macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        -
          macro: '{$PSU_CRIT_STATUS}'
          value: '6'
        -
          macro: '{$SNMP.TIMEOUT}'
          value: 5m
        -
          macro: '{$TEMP_CRIT}'
          value: '60'
        -
          macro: '{$TEMP_CRIT:"Routing Engine"}'
          value: '80'
        -
          macro: '{$TEMP_CRIT_LOW}'
          value: '5'
        -
          macro: '{$TEMP_WARN}'
          value: '50'
        -
          macro: '{$TEMP_WARN:"Routing Engine"}'
          value: '70'
      dashboards:
        -
          uuid: a86ee01e21e242fabd4e7d28fd20b64d
          name: 'Network interfaces'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
      valuemaps:
        -
          uuid: 051469b3900f4c3c9c58d344998ca9ce
          name: 'EtherLike-MIB::dot3StatsDuplexStatus'
          mappings:
            -
              value: '1'
              newvalue: unknown
            -
              value: '2'
              newvalue: halfDuplex
            -
              value: '3'
              newvalue: fullDuplex
        -
          uuid: f62664d3b22e468098f3693ac6a41109
          name: 'IF-MIB::ifOperStatus'
          mappings:
            -
              value: '1'
              newvalue: up
            -
              value: '2'
              newvalue: down
            -
              value: '4'
              newvalue: unknown
            -
              value: '5'
              newvalue: dormant
            -
              value: '6'
              newvalue: notPresent
            -
              value: '7'
              newvalue: lowerLayerDown
        -
          uuid: 16e7a6a731af47d58fef087f6b2975d7
          name: 'IF-MIB::ifType'
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: regular1822
            -
              value: '3'
              newvalue: hdh1822
            -
              value: '4'
              newvalue: ddnX25
            -
              value: '5'
              newvalue: rfc877x25
            -
              value: '6'
              newvalue: ethernetCsmacd
            -
              value: '7'
              newvalue: iso88023Csmacd
            -
              value: '8'
              newvalue: iso88024TokenBus
            -
              value: '9'
              newvalue: iso88025TokenRing
            -
              value: '10'
              newvalue: iso88026Man
            -
              value: '11'
              newvalue: starLan
            -
              value: '12'
              newvalue: proteon10Mbit
            -
              value: '13'
              newvalue: proteon80Mbit
            -
              value: '14'
              newvalue: hyperchannel
            -
              value: '15'
              newvalue: fddi
            -
              value: '16'
              newvalue: lapb
            -
              value: '17'
              newvalue: sdlc
            -
              value: '18'
              newvalue: ds1
            -
              value: '19'
              newvalue: e1
            -
              value: '20'
              newvalue: basicISDN
            -
              value: '21'
              newvalue: primaryISDN
            -
              value: '22'
              newvalue: propPointToPointSerial
            -
              value: '23'
              newvalue: ppp
            -
              value: '24'
              newvalue: softwareLoopback
            -
              value: '25'
              newvalue: eon
            -
              value: '26'
              newvalue: ethernet3Mbit
            -
              value: '27'
              newvalue: nsip
            -
              value: '28'
              newvalue: slip
            -
              value: '29'
              newvalue: ultra
            -
              value: '30'
              newvalue: ds3
            -
              value: '31'
              newvalue: sip
            -
              value: '32'
              newvalue: frameRelay
            -
              value: '33'
              newvalue: rs232
            -
              value: '34'
              newvalue: para
            -
              value: '35'
              newvalue: arcnet
            -
              value: '36'
              newvalue: arcnetPlus
            -
              value: '37'
              newvalue: atm
            -
              value: '38'
              newvalue: miox25
            -
              value: '39'
              newvalue: sonet
            -
              value: '40'
              newvalue: x25ple
            -
              value: '41'
              newvalue: iso88022llc
            -
              value: '42'
              newvalue: localTalk
            -
              value: '43'
              newvalue: smdsDxi
            -
              value: '44'
              newvalue: frameRelayService
            -
              value: '45'
              newvalue: v35
            -
              value: '46'
              newvalue: hssi
            -
              value: '47'
              newvalue: hippi
            -
              value: '48'
              newvalue: modem
            -
              value: '49'
              newvalue: aal5
            -
              value: '50'
              newvalue: sonetPath
            -
              value: '51'
              newvalue: sonetVT
            -
              value: '52'
              newvalue: smdsIcip
            -
              value: '53'
              newvalue: propVirtual
            -
              value: '54'
              newvalue: propMultiplexor
            -
              value: '55'
              newvalue: ieee80212
            -
              value: '56'
              newvalue: fibreChannel
            -
              value: '57'
              newvalue: hippiInterface
            -
              value: '58'
              newvalue: frameRelayInterconnect
            -
              value: '59'
              newvalue: aflane8023
            -
              value: '60'
              newvalue: aflane8025
            -
              value: '61'
              newvalue: cctEmul
            -
              value: '62'
              newvalue: fastEther
            -
              value: '63'
              newvalue: isdn
            -
              value: '64'
              newvalue: v11
            -
              value: '65'
              newvalue: v36
            -
              value: '66'
              newvalue: g703at64k
            -
              value: '67'
              newvalue: g703at2mb
            -
              value: '68'
              newvalue: qllc
            -
              value: '69'
              newvalue: fastEtherFX
            -
              value: '70'
              newvalue: channel
            -
              value: '71'
              newvalue: ieee80211
            -
              value: '72'
              newvalue: ibm370parChan
            -
              value: '73'
              newvalue: escon
            -
              value: '74'
              newvalue: dlsw
            -
              value: '75'
              newvalue: isdns
            -
              value: '76'
              newvalue: isdnu
            -
              value: '77'
              newvalue: lapd
            -
              value: '78'
              newvalue: ipSwitch
            -
              value: '79'
              newvalue: rsrb
            -
              value: '80'
              newvalue: atmLogical
            -
              value: '81'
              newvalue: ds0
            -
              value: '82'
              newvalue: ds0Bundle
            -
              value: '83'
              newvalue: bsc
            -
              value: '84'
              newvalue: async
            -
              value: '85'
              newvalue: cnr
            -
              value: '86'
              newvalue: iso88025Dtr
            -
              value: '87'
              newvalue: eplrs
            -
              value: '88'
              newvalue: arap
            -
              value: '89'
              newvalue: propCnls
            -
              value: '90'
              newvalue: hostPad
            -
              value: '91'
              newvalue: termPad
            -
              value: '92'
              newvalue: frameRelayMPI
            -
              value: '93'
              newvalue: x213
            -
              value: '94'
              newvalue: adsl
            -
              value: '95'
              newvalue: radsl
            -
              value: '96'
              newvalue: sdsl
            -
              value: '97'
              newvalue: vdsl
            -
              value: '98'
              newvalue: iso88025CRFPInt
            -
              value: '99'
              newvalue: myrinet
            -
              value: '100'
              newvalue: voiceEM
            -
              value: '101'
              newvalue: voiceFXO
            -
              value: '102'
              newvalue: voiceFXS
            -
              value: '103'
              newvalue: voiceEncap
            -
              value: '104'
              newvalue: voiceOverIp
            -
              value: '105'
              newvalue: atmDxi
            -
              value: '106'
              newvalue: atmFuni
            -
              value: '107'
              newvalue: atmIma
            -
              value: '108'
              newvalue: pppMultilinkBundle
            -
              value: '109'
              newvalue: ipOverCdlc
            -
              value: '110'
              newvalue: ipOverClaw
            -
              value: '111'
              newvalue: stackToStack
            -
              value: '112'
              newvalue: virtualIpAddress
            -
              value: '113'
              newvalue: mpc
            -
              value: '114'
              newvalue: ipOverAtm
            -
              value: '115'
              newvalue: iso88025Fiber
            -
              value: '116'
              newvalue: tdlc
            -
              value: '117'
              newvalue: gigabitEthernet
            -
              value: '118'
              newvalue: hdlc
            -
              value: '119'
              newvalue: lapf
            -
              value: '120'
              newvalue: v37
            -
              value: '121'
              newvalue: x25mlp
            -
              value: '122'
              newvalue: x25huntGroup
            -
              value: '123'
              newvalue: trasnpHdlc
            -
              value: '124'
              newvalue: interleave
            -
              value: '125'
              newvalue: fast
            -
              value: '126'
              newvalue: ip
            -
              value: '127'
              newvalue: docsCableMaclayer
            -
              value: '128'
              newvalue: docsCableDownstream
            -
              value: '129'
              newvalue: docsCableUpstream
            -
              value: '130'
              newvalue: a12MppSwitch
            -
              value: '131'
              newvalue: tunnel
            -
              value: '132'
              newvalue: coffee
            -
              value: '133'
              newvalue: ces
            -
              value: '134'
              newvalue: atmSubInterface
            -
              value: '135'
              newvalue: l2vlan
            -
              value: '136'
              newvalue: l3ipvlan
            -
              value: '137'
              newvalue: l3ipxvlan
            -
              value: '138'
              newvalue: digitalPowerline
            -
              value: '139'
              newvalue: mediaMailOverIp
            -
              value: '140'
              newvalue: dtm
            -
              value: '141'
              newvalue: dcn
            -
              value: '142'
              newvalue: ipForward
            -
              value: '143'
              newvalue: msdsl
            -
              value: '144'
              newvalue: ieee1394
            -
              value: '145'
              newvalue: if-gsn
            -
              value: '146'
              newvalue: dvbRccMacLayer
            -
              value: '147'
              newvalue: dvbRccDownstream
            -
              value: '148'
              newvalue: dvbRccUpstream
            -
              value: '149'
              newvalue: atmVirtual
            -
              value: '150'
              newvalue: mplsTunnel
            -
              value: '151'
              newvalue: srp
            -
              value: '152'
              newvalue: voiceOverAtm
            -
              value: '153'
              newvalue: voiceOverFrameRelay
            -
              value: '154'
              newvalue: idsl
            -
              value: '155'
              newvalue: compositeLink
            -
              value: '156'
              newvalue: ss7SigLink
            -
              value: '157'
              newvalue: propWirelessP2P
            -
              value: '158'
              newvalue: frForward
            -
              value: '159'
              newvalue: rfc1483
            -
              value: '160'
              newvalue: usb
            -
              value: '161'
              newvalue: ieee8023adLag
            -
              value: '162'
              newvalue: bgppolicyaccounting
            -
              value: '163'
              newvalue: frf16MfrBundle
            -
              value: '164'
              newvalue: h323Gatekeeper
            -
              value: '165'
              newvalue: h323Proxy
            -
              value: '166'
              newvalue: mpls
            -
              value: '167'
              newvalue: mfSigLink
            -
              value: '168'
              newvalue: hdsl2
            -
              value: '169'
              newvalue: shdsl
            -
              value: '170'
              newvalue: ds1FDL
            -
              value: '171'
              newvalue: pos
            -
              value: '172'
              newvalue: dvbAsiIn
            -
              value: '173'
              newvalue: dvbAsiOut
            -
              value: '174'
              newvalue: plc
            -
              value: '175'
              newvalue: nfas
            -
              value: '176'
              newvalue: tr008
            -
              value: '177'
              newvalue: gr303RDT
            -
              value: '178'
              newvalue: gr303IDT
            -
              value: '179'
              newvalue: isup
            -
              value: '180'
              newvalue: propDocsWirelessMaclayer
            -
              value: '181'
              newvalue: propDocsWirelessDownstream
            -
              value: '182'
              newvalue: propDocsWirelessUpstream
            -
              value: '183'
              newvalue: hiperlan2
            -
              value: '184'
              newvalue: propBWAp2Mp
            -
              value: '185'
              newvalue: sonetOverheadChannel
            -
              value: '186'
              newvalue: digitalWrapperOverheadChannel
            -
              value: '187'
              newvalue: aal2
            -
              value: '188'
              newvalue: radioMAC
            -
              value: '189'
              newvalue: atmRadio
            -
              value: '190'
              newvalue: imt
            -
              value: '191'
              newvalue: mvl
            -
              value: '192'
              newvalue: reachDSL
            -
              value: '193'
              newvalue: frDlciEndPt
            -
              value: '194'
              newvalue: atmVciEndPt
            -
              value: '195'
              newvalue: opticalChannel
            -
              value: '196'
              newvalue: opticalTransport
            -
              value: '197'
              newvalue: propAtm
            -
              value: '198'
              newvalue: voiceOverCable
            -
              value: '199'
              newvalue: infiniband
            -
              value: '200'
              newvalue: teLink
            -
              value: '201'
              newvalue: q2931
            -
              value: '202'
              newvalue: virtualTg
            -
              value: '203'
              newvalue: sipTg
            -
              value: '204'
              newvalue: sipSig
            -
              value: '205'
              newvalue: docsCableUpstreamChannel
            -
              value: '206'
              newvalue: econet
            -
              value: '207'
              newvalue: pon155
            -
              value: '208'
              newvalue: pon622
            -
              value: '209'
              newvalue: bridge
            -
              value: '210'
              newvalue: linegroup
            -
              value: '211'
              newvalue: voiceEMFGD
            -
              value: '212'
              newvalue: voiceFGDEANA
            -
              value: '213'
              newvalue: voiceDID
            -
              value: '214'
              newvalue: mpegTransport
            -
              value: '215'
              newvalue: sixToFour
            -
              value: '216'
              newvalue: gtp
            -
              value: '217'
              newvalue: pdnEtherLoop1
            -
              value: '218'
              newvalue: pdnEtherLoop2
            -
              value: '219'
              newvalue: opticalChannelGroup
            -
              value: '220'
              newvalue: homepna
            -
              value: '221'
              newvalue: gfp
            -
              value: '222'
              newvalue: ciscoISLvlan
            -
              value: '223'
              newvalue: actelisMetaLOOP
            -
              value: '224'
              newvalue: fcipLink
            -
              value: '225'
              newvalue: rpr
            -
              value: '226'
              newvalue: qam
            -
              value: '227'
              newvalue: lmp
            -
              value: '228'
              newvalue: cblVectaStar
            -
              value: '229'
              newvalue: docsCableMCmtsDownstream
            -
              value: '230'
              newvalue: adsl2
            -
              value: '231'
              newvalue: macSecControlledIF
            -
              value: '232'
              newvalue: macSecUncontrolledIF
            -
              value: '233'
              newvalue: aviciOpticalEther
            -
              value: '234'
              newvalue: atmbond
            -
              value: '235'
              newvalue: voiceFGDOS
            -
              value: '236'
              newvalue: mocaVersion1
            -
              value: '237'
              newvalue: ieee80216WMAN
            -
              value: '238'
              newvalue: adsl2plus
            -
              value: '239'
              newvalue: dvbRcsMacLayer
            -
              value: '240'
              newvalue: dvbTdm
            -
              value: '241'
              newvalue: dvbRcsTdma
            -
              value: '242'
              newvalue: x86Laps
            -
              value: '243'
              newvalue: wwanPP
            -
              value: '244'
              newvalue: wwanPP2
            -
              value: '245'
              newvalue: voiceEBS
            -
              value: '246'
              newvalue: ifPwType
            -
              value: '247'
              newvalue: ilan
            -
              value: '248'
              newvalue: pip
            -
              value: '249'
              newvalue: aluELP
            -
              value: '250'
              newvalue: gpon
            -
              value: '251'
              newvalue: vdsl2
            -
              value: '252'
              newvalue: capwapDot11Profile
            -
              value: '253'
              newvalue: capwapDot11Bss
            -
              value: '254'
              newvalue: capwapWtpVirtualRadio
            -
              value: '255'
              newvalue: bits
            -
              value: '256'
              newvalue: docsCableUpstreamRfPort
            -
              value: '257'
              newvalue: cableDownstreamRfPort
            -
              value: '258'
              newvalue: vmwareVirtualNic
            -
              value: '259'
              newvalue: ieee802154
            -
              value: '260'
              newvalue: otnOdu
            -
              value: '261'
              newvalue: otnOtu
            -
              value: '262'
              newvalue: ifVfiType
            -
              value: '263'
              newvalue: g9981
            -
              value: '264'
              newvalue: g9982
            -
              value: '265'
              newvalue: g9983
            -
              value: '266'
              newvalue: aluEpon
            -
              value: '267'
              newvalue: aluEponOnu
            -
              value: '268'
              newvalue: aluEponPhysicalUni
            -
              value: '269'
              newvalue: aluEponLogicalLink
            -
              value: '270'
              newvalue: aluGponOnu
            -
              value: '271'
              newvalue: aluGponPhysicalUni
            -
              value: '272'
              newvalue: vmwareNicTeam
            -
              value: '277'
              newvalue: docsOfdmDownstream
            -
              value: '278'
              newvalue: docsOfdmaUpstream
            -
              value: '279'
              newvalue: gfast
            -
              value: '280'
              newvalue: sdci
            -
              value: '281'
              newvalue: xboxWireless
            -
              value: '282'
              newvalue: fastdsl
            -
              value: '283'
              newvalue: docsCableScte55d1FwdOob
            -
              value: '284'
              newvalue: docsCableScte55d1RetOob
            -
              value: '285'
              newvalue: docsCableScte55d2DsOob
            -
              value: '286'
              newvalue: docsCableScte55d2UsOob
            -
              value: '287'
              newvalue: docsCableNdf
            -
              value: '288'
              newvalue: docsCableNdr
            -
              value: '289'
              newvalue: ptm
            -
              value: '290'
              newvalue: ghn
        -
          uuid: 19312195ee63426e8615469ed63a1641
          name: 'JUNIPER-ALARM-MIB::jnxOperatingState'
          mappings:
            -
              value: '1'
              newvalue: unknown
            -
              value: '2'
              newvalue: running
            -
              value: '3'
              newvalue: ready
            -
              value: '4'
              newvalue: reset
            -
              value: '5'
              newvalue: runningAtFullSpeed
            -
              value: '6'
              newvalue: 'down or off'
            -
              value: '7'
              newvalue: standby
        -
          uuid: ffe599f427634f30b2395db212f7f5b3
          name: 'JUNIPER-ALARM-MIB::jnxRedAlarmState'
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: 'off'
            -
              value: '3'
              newvalue: 'on - RedAlarm'
        -
          uuid: 053f3c2260054275aa8d05ad05d041a1
          name: 'Service state'
          mappings:
            -
              value: '0'
              newvalue: Down
            -
              value: '1'
              newvalue: Up
        -
          uuid: ced630b6e57344d08e325ba23bfa97a3
          name: zabbix.host.available
          mappings:
            -
              value: '0'
              newvalue: 'not available'
            -
              value: '1'
              newvalue: available
            -
              value: '2'
              newvalue: unknown
  triggers:
    -
      uuid: 14620240d05849cf8ddd0b7a3a6157c0
      expression: '(last(/Template Juniper SNMP - BEE/system.hw.uptime[hrSystemUptime.0])>0 and last(/Template Juniper SNMP - BEE/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/Template Juniper SNMP - BEE/system.hw.uptime[hrSystemUptime.0])=0 and last(/Template Juniper SNMP - BEE/system.net.uptime[sysUpTime.0])<10m)'
      name: 'Host has been restarted'
      event_name: '{HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        -
          name: 'No SNMP data collection'
          expression: 'max(/Template Juniper SNMP - BEE/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        -
          tag: scope
          value: notice
